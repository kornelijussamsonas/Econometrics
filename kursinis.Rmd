---
title: "Iskaitiniu eismo ivykiu Lietuvos keliuose analize"
author: "Kornelijus Samsonas, Linas Å yvis"
output: pdf_document
---

#Nuskaitom duomenis
```{r}
rawdata<-read.csv2('tidy2015.csv', header = T)
agreguoti <- read.csv2("agreguoti2009-2015.csv", header = T)
gyventojai <- read.csv2("gyventojai.csv", header = T)
```

#Paliekam tik 5 didziuosius miestus
```{r}
data <- rawdata[rawdata[,1] == "Vilniaus m. sav." | 
                     rawdata[,1] == "Kauno m. sav." | 
                     rawdata[,1] == "Klaipedos m. sav." | 
                     rawdata[,1] == "siauliu m. sav." | 
                     rawdata[,1] == "Panevezio m. sav.",]
```

#Tvarkom blaivumo stulpeli(25)
```{r}
data[data[,25] == "Apsvaiges nuo narkotiniu, psichotropiniu ar kitu psichika veikianciu medziagu" | data[,25] == "Atsisake buti patikrintas",25] <- "Neblaivus"
data[data[,25] == "Neapsvaiges",25] <- "Blaivus"
data[,25] <- factor(data[,25])
```

#Pritaikom rodiklius 1000 gyv.
```{r}
kgyv <- gyventojai[,3]/1000
gyventojai <- cbind(gyventojai, kgyv)
```

#Skaiciuojam neblaivius
```{r}
miestai <- c("Vilniaus m. sav.", "Kauno m. sav.", "Klaipedos m. sav.", "siauliu m. sav.", "Panevezio m. sav.")
neblaivus <- as.numeric(0)
for(i in 1:5)
neblaivus[i] <- nrow(data[data[,25] == "Neblaivus" & data[,1] == miestai[i],]) / gyventojai[gyventojai[,1] == 2015 & gyventojai[,2] == miestai[i], 6]
rbind(miestai, round(neblaivus, digits = 3))
```

#Forecastinam autoivykius
```{r}
a <- ts(agreguoti[agreguoti[,3] == "Lietuvos Respublika", 4], start=c(2009,1),  frequency = 12)
##sum(gyventojai[gyventojai[,1] == 2015, 3])
plot(a)
b <- ts(agreguoti[agreguoti[,3] == "Vilniaus m. sav.", 4] / gyventojai[gyventojai[,1] == 2015 & gyventojai[,2] == miestai[1], 6], start=c(2009,1), frequency = 12)
plot(b)

```


Tikrinsime hipoteze ar Vilniaus mieste eismo ivykiu kaltininkai dazniau yra Vyrai nei moterys.

H0= V sk. = 

```{r}
Vilniusm <- rawdata[rawdata[,1] == "Vilniaus m. sav.",]
Kaunasm <- rawdata[rawdata[,1] == "Kauno m. sav.",]
Siauliaim <- rawdata[rawdata[,1] == "siauliu m. sav.",]
Klaipedam <- rawdata[rawdata[,1] == "Klaipedos m. sav.",]
Panevezysm <- rawdata[rawdata[,1] == "Panevezio m. sav.",]

```


### Kaltininku procentas miestuose (Vyrai/Moterys)

Kaltininku procentas Vilniaus mieste.

```{r}
vyruskV<-sum(na.omit(as.numeric(Vilniusm[,19]=="Vyras")))
moteruskV<-sum(na.omit(as.numeric(Vilniusm[,19]=="Moteris")))
visoV<-(vyruskV+moteruskV)
vyruprocV=vyruskV/visoV*100
moteruprocV=moteruskV/visoV*100
```

Kaltininku procentas Kauno mieste.

```{r}
vyruskK<-sum(na.omit(as.numeric(Kaunasm[,19]=="Vyras")))
moteruskK<-sum(na.omit(as.numeric(Kaunasm[,19]=="Moteris")))
visoK<-(vyruskK+moteruskK)
vyruprocK=vyruskK/visoK*100
moteruprocK=moteruskK/visoK*100
```

Kaltininku procentas Siauliu mieste.

```{r}
vyruskS<-sum(na.omit(as.numeric(Siauliaim[,19]=="Vyras")))
moteruskS<-sum(na.omit(as.numeric(Siauliaim[,19]=="Moteris")))
visoS<-(vyruskS+moteruskS)
vyruprocS=vyruskS/visoS*100
moteruprocS=moteruskS/visoS*100
```


Kaltininku procentas Klaipedos mieste.

```{r}
vyruskKl<-sum(na.omit(as.numeric(Klaipedam[,19]=="Vyras")))
moteruskKl<-sum(na.omit(as.numeric(Klaipedam[,19]=="Moteris")))
visoKl<-(vyruskKl+moteruskKl)
vyruprocKl=vyruskKl/visoKl*100
moteruprocKl=moteruskKl/visoKl*100
```

Kaltininku procentas Panevezio mieste.

```{r}
vyruskP<-sum(na.omit(as.numeric(Panevezysm[,19]=="Vyras")))
moteruskP<-sum(na.omit(as.numeric(Panevezysm[,19]=="Moteris")))
visoP<-(vyruskP+moteruskP)
vyruprocP=vyruskP/visoP*100
moteruprocP=moteruskP/visoP*100
```



Tikrinsime hipoteze ar Vilniaus mieste eismo ivykiu kaltininkai dazniau yra Vyrai nei moterys.

```{r}
Vilniusm <- rawdata[rawdata[,1] == "Vilniaus m. sav.",]
sum(Vilniusm[,"Lytis"]=="Vyras")
```


Palyginti zuvusiu/suzeistu menesinius vidurkius tarp laikotarpiu ir vietu.
Ar skiriasi ivykiu skaicius nakti ir diena?


```{r}
library(lubridate)
YrMonth<-paste(year(rawdata[,2]),'-', month(rawdata[,2]),sep='')
sum(agreguoti[agreguoti[,3] == "Lietuvos Respublika", 4] && agreguoti[,1] == 2015)

metai <- agreguoti[agreguoti[,1]==2015,]
```


